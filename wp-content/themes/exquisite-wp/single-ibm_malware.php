<?php get_header(); ?>
<div class="postview">
	<?php if (have_posts()) :  while (have_posts()) : the_post(); ?>

	<!-- top section -->
	<div class="row collapse">
		<div class="phone-four eight columns post posthead">
			<div class="post-title">
			  	<h1><?php the_title(); ?></h1>
			</div>
		</div>
	</div>


	<section class="row malware-section">

		<div class="phone-four twelve columns">
			<article <?php post_class('post'); ?> id="post-<?php the_ID(); ?>">

				<div class="row post-details">

					<div class="phone-four six columns metas post-details">

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_notification_type", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>NOTIFICATION TYPE: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_notification_type", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_notification_type", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<div class="row">
							<div class="mobile-four four columns"><p>PUBLICATION DATE: <span class="blue-text hide-on-desktops"><?php echo get_the_date('M d, Y', $post->ID); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo get_the_date('M d, Y', $post->ID); ?></span></p></div>
						</div>
						
						<?php if ( get_post_meta( $post->ID, "_ibm_malware_analysis_provided_by", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>ANALYSIS PROVIDED BY: <span class="blue-text hide-on-desktops"><?php echo esc_html(get_post_meta( $post->ID, "_ibm_malware_analysis_provided_by", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo esc_html(get_post_meta( $post->ID, "_ibm_malware_analysis_provided_by", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_notification_date", true ) ) { ?>
							<?php
							$notification_date = date_create(esc_html(get_post_meta($post->ID, "_ibm_malware_notification_date", true)));
							$notification_date = date_format($notification_date, "M d, Y");
							?>
						<div class="row">
							<div class="mobile-four four columns"><p>PUBLICATION DATE: <span class="blue-text hide-on-desktops"><?php echo  $notification_date; ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  $notification_date; ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_malware_aliases", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>MALWARE ALIASES: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_malware_aliases", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_malware_aliases", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_classification_description_history", true ) ) { ?>
						<div class="row mv-info">
							<div class="phone-four twelve columns">
								<h2>CLASSIFICATION, DESCRIPTION, HISTORY:</h2>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_classification_description_history", true )); ?></p>
							</div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_version", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>VERSION: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_version", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_version", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_vendor", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>VENDOR: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_vendor", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_vendor", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_product", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>PRODUCT: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_product", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_product", true )); ?></span></p></div>
						</div>
						<?php } ?>

					</div>

					<div class="phone-four six columns metas info-card">
						<h2>INFO CARD</h2>
						<?php if ( get_post_meta( $post->ID, "_ibm_malware_bugat_trojan", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>FAMILY NAME: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_bugat_trojan", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_bugat_trojan", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_type", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>TYPE: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_type", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_type", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_affected_os", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>AFFECTED OS: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_os", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_os", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_affected_arch", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>AFFECTED ARCH: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_arch", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_arch", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_affected_browsers", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>AFFECTED BROWSERS: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_browsers", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_affected_browsers", true )); ?></span></p></div>
						</div>
						<?php } ?>
						<?php if ( get_post_meta( $post->ID, "_ibm_malware_on_startup", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>ON STARTUP: <span class="blue-text hide-on-desktops uppercase"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_on_startup", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text uppercase"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_on_startup", true )); ?></span></p></div>
						</div>
						<?php } ?>

						<?php if ( get_post_meta( $post->ID, "_ibm_malware_storage_method", true ) ) { ?>
						<div class="row">
							<div class="mobile-four four columns"><p>STORAGE METHOD: <span class="blue-text hide-on-desktops"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_storage_method", true )); ?></span></p></div>
							<div class="mobile-two eight columns hide-on-phones"><p><span class="blue-text"><?php echo  esc_html(get_post_meta( $post->ID, "_ibm_malware_storage_method", true )); ?></span></p></div>
						</div>
						<?php } ?>
					</div>

				</div>
				
				<?php if ( get_post_meta( $post->ID, "_ibm_malware_classification_description_history", true ) ) { ?>
				<div class="row">
					<div class="phone-four six  columns">
						<h2>TECHNICAL DESCRIPTION</h2>
						<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_classification_description_history", true )); ?></p>
					</div>
				</div>
				<?php } ?>


				<!--Details section -->
				<div class="row malware-descritions">
					<div class="phone-four twelve columns">
						<h3>DETAILS</h3>
						<?php if ( get_post_meta( $post->ID, "_ibm_malware_propagation_technique", true ) ) { ?>
							<div class="row">
								<div class="phone-four twelve  columns">
									<p><strong>Propagation Technique</strong></p>
									<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_propagation_technique", true )); ?></p>
								</div>
							</div>
						<?php } ?>

						<div class="row malware-details">
							<?php if ( get_post_meta( $post->ID, "_ibm_malware_installation_flow", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Installation Flow</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_installation_flow", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_patching_hooking_techniques", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Patching/Hooking Techniques</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_patching_hooking_techniques", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_evasion_techniques", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Evasion Techniques (Anti Debugging/research or VM)</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_evasion_techniques", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_persistency_strategy_tactics", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Persistency Strategy and Tactics</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_persistency_strategy_tactics", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_cc_communications", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>C &amp; C Communications</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_cc_communications", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_main_capabilities", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Main Capabilities</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_main_capabilities", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_main_targets", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Main Targets</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_main_targets", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_special_notable_capacities", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Special or Notable Capacities</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_special_notable_capacities", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_ibm_security_protection", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>IBM Security Protection</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_ibm_security_protection", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_additional_sample_analysis", true ) ) { ?>
							<div class="phone-four six columns">
								<p><strong>Additional Sample Analysis</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_additional_sample_analysis", true )); ?></p>
							</div>
							<?php } ?>

							<?php if ( get_post_meta( $post->ID, "_ibm_malware_references_links_external_reports_blogs", true ) ) { ?>
							<div class="phone-four twelve columns">
								<p><strong>References or Links to external reports or blogs</strong></p>
								<p><?php echo  XforceStaticFunctions::remove_bad_tags(get_post_meta( $post->ID, "_ibm_malware_references_links_external_reports_blogs", true )); ?></p>
							</div>
							<?php } ?>

						</div>


					</div>
				</div>


			
  			</article>

		</div>

	</section>

<!--Info list-->
	<?php 
	$security_products = get_post_meta( $post->ID, "_ibm_malware_ibm_security_protection_list", false );
		if(!is_array($security_products) || empty($security_products)){
			$security_products = array();
		}else{
			if(is_array($security_products[0])){
				$security_products = $security_products[0];
			}else{
				$security_products = array();
			}

		}
  ?>

	<div class="row info-list collapse short">
		<div class="mobile-one one columns main">
		  	<span><?php echo count($security_products); ?></span>
		  	<p>IBM Security <br/>Protection</p>
		  	<?php 
			  	if(count($security_products) > 4){
			  		?>
			  		<a href="#" class="product_btn" title="View All">View All</a>
			 <?php }?> 
		</div>

	  	<div class="mobile-three eleven columns">
	  		<div class="phone-four twelve columns">
	  			<strong>Affected Products</strong>
	  		</div>
	  		<?php
	  		if (count($security_products) > 0) {
	  		?>
	  		<?php foreach($security_products as $security_product){ ?>
	  		<div class="phone-four twelve columns product">
	  			<?php echo $security_product; ?>
	  		</div>
	  		<?php } ?>
	  		<?php }else { ?>
	  		<div class="phone-four twelve columns product">
	  			<strong>None Found</strong>
	  		</div>
	  		<?php } ?>
		</div>
	</div>
	
  <?php 
  $revision_history = get_post_meta( $post->ID, "_ibm_malware_revision_history", true ); 
  if (!empty($revision_history)) {
  ?>
	<div class="row last-module">
		<div class="phone-four twelve columns post-details">
			<h2 class="history">Revision History</h2>			
			<p><?php echo nl2br($revision_history); ?></p>
		</div>
	</div>
	<?php } ?>
	<?php endwhile; ?>
  	<?php else : ?>
    	<p><?php _e( 'Please add posts from your WordPress admin page.', THB_THEME_NAME ); ?></p>
  	<?php endif; ?>
</div>
<?php get_footer(); ?>

